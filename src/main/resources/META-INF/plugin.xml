<idea-plugin require-restart="true">
    <id>Git Scope</id>
    <name>Git Scope</name>
    <vendor>WOELKIT, M.Wållberg</vendor>
    <version>auto</version>
    <description><![CDATA[
    <p><b>See all your feature branch changes at a glance—even after committing.</b></p>

    <p>IntelliJ's built-in version control only shows uncommitted changes. Once you commit, all change indicators disappear.
    Git Scope solves this by letting you compare your current work against any Git reference—branches, tags, or commits—making
    it perfect for tracking feature branch progress across multiple commits.</p>

    <p><b>Key Features:</b></p>
    <ul>
        <li><b>Visual change tracking</b> — See exactly what changed between HEAD and your target branch</li>
        <li><b>Editor gutter indicators</b> — Line-by-line change markers (added/modified/deleted) right in your editor</li>
        <li><b>File tree diff browser</b> — Browse all modified files in a dedicated tool window</li>
        <li><b>Project file colors</b> — Instantly spot changed files with color-coded highlighting</li>
        <li><b>Smart scopes</b> — Use Git Scope with IntelliJ's search, replace, and inspection features</li>
    </ul>
    <p><b>Perfect for:</b></p>
    <ul>
        <li>Reviewing all changes in a feature branch before creating a pull request</li>
        <li>Tracking progress against your target branch (e.g., main, develop, release)</li>
        <li>Performing code inspections or refactoring only on files you've changed</li>
        <li>Understanding what's different between your work and any historical reference</li>
    </ul>
    ]]></description>
    <change-notes>auto</change-notes>

    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.lang</depends>
    <depends>com.intellij.modules.vcs</depends>
    <depends>Git4Idea</depends>

    <applicationListeners>
        <listener class="listener.MyBulkFileListener" topic="com.intellij.openapi.vfs.newvfs.BulkFileListener"/>
        <listener class="listener.MyDynamicPluginListener" topic="com.intellij.ide.plugins.DynamicPluginListener"/>
    </applicationListeners>

    <projectListeners>
        <listener class="listener.MyToolWindowListener" topic="com.intellij.openapi.wm.ex.ToolWindowManagerListener"/>
        <listener class="listener.VcsStartup" topic="com.intellij.openapi.vcs.VcsMappingListener"/>
        <listener class="listener.MyChangeListListener" topic="com.intellij.openapi.vcs.changes.ChangeListListener"/>
        <listener class="listener.MyGitRepositoryChangeListener" topic="git4idea.repo.GitRepository$GIT_REPO_CHANGE"/>
        <listener class="listener.MyFileEditorManagerListener"
                  topic="com.intellij.openapi.fileEditor.FileEditorManagerListener"/>
    </projectListeners>
    <extensions defaultExtensionNs="com.intellij">
        <statusBarWidgetFactory
                implementation="statusBar.MyStatusBarWidgetFactory" id="GitScopeStatusBar"/>
        <toolWindow
                id="Git Scope"
                secondary="true"
                icon="AllIcons.Actions.Diff"
                anchor="left"
                factoryClass="toolwindow.ToolWindowUIFactory"
                canCloseContents="true"
        />
        <selectInTarget implementation="implementation.scope.MyScopeInTarget"/>

        <!-- Config (Persistent) -->
        <projectService serviceImplementation="state.State"/>
        <projectService serviceImplementation="service.StatusBarService"/>
        <projectService serviceImplementation="service.GitService"/>
        <projectService serviceImplementation="service.ViewService"/>
        <projectService serviceImplementation="service.TargetBranchService"/>
        <projectService serviceImplementation="implementation.compare.ChangesService"/>
        <projectService
                serviceInterface="service.ToolWindowServiceInterface"
                serviceImplementation="service.ToolWindowService"/>
        <vcs.fileStatusProvider implementation="implementation.fileStatus.GitScopeFileStatusProvider"/>
    </extensions>

    <actions>
        <action id="ToggleHead" class="listener.ToggleHeadAction" text="GitScope: Toggle Head" description="ToggleHead">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
            <keyboard-shortcut keymap="$default" first-keystroke="alt H"/>
        </action>
        <action id="listener.VcsContextMenuAction" class="listener.VcsContextMenuAction" text="Use Commit as Git Scope">
            <add-to-group group-id="Vcs.Log.ContextMenu" anchor="after"
                          relative-to-action="Vcs.CopyRevisionNumberAction"/>
        </action>

        <!-- Tab context menu actions for Git Scope tool window -->
        <action id="GitScope.MoveTabLeft" class="toolwindow.actions.TabMoveActions$MoveTabLeft" text="Move Tab Left">
            <add-to-group group-id="ToolWindowContextMenu" anchor="first"/>
        </action>
        <action id="GitScope.MoveTabRight" class="toolwindow.actions.TabMoveActions$MoveTabRight" text="Move Tab Right">
            <add-to-group group-id="ToolWindowContextMenu" anchor="after" relative-to-action="GitScope.MoveTabLeft"/>
        </action>
        <action id="GitScope.RenameTab" class="toolwindow.actions.RenameTabAction" text="Rename Tab">
            <add-to-group group-id="ToolWindowContextMenu" anchor="after" relative-to-action="GitScope.MoveTabRight"/>
        </action>
        <action id="GitScope.ResetTabName" class="toolwindow.actions.ResetTabNameAction" text="Reset Tab Name">
            <add-to-group group-id="ToolWindowContextMenu" anchor="after" relative-to-action="GitScope.RenameTab"/>
        </action>
    </actions>

</idea-plugin>