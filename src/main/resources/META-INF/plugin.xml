<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin
        require-restart="true">
    <!-- Public plugin name should be written in Title Case.
         Guidelines: https://plugins.jetbrains.com/docs/marketplace/plugin-overview-page.html#plugin-name -->
    <!-- Unique identifier of the plugin. It should be FQN. It cannot be changed between the plugin versions. -->
    <id>Git Scope</id>
    <name>Git Scope</name>
    <vendor>WOELKIT</vendor>
    <product-descriptor code="PGITSCOPE" release-date="20230622" release-version="20231"/>
    <version>2023.1.2</version>
    <description><![CDATA[
        Create custom "scopes" for any target branch. Selectable in a tool window, which is then called **GIT SCOPE**.
        The Current "scope" is displayed as

        <ul>
          <li>diff in the tool window
          <li>"line status" in the "line gutter"
          <li>custom "scope" and finally as a
          <li>status bar widget
        </ul>
    ]]></description>

    <change-notes><![CDATA[
      2023.1.2
        <ul>
        <li>Fix compatibility issues</li>
        </ul>
      2023.1.1
        <ul>
        <li>Complete overhaul of the plugin
        <li>Cleaner UI
        <li>Tab-based tool window
        <li>HEAD tab is always present by default
        <li>Add new tab to create a new *GitScope*
        <li>Tabs are persisted. This way you can keep "favorites" like a "main" branch tab
        <li>Use the "ToggleHead" action to switch between HEAD and the (last) selected tab (Alt+H)
        </ul>
    ]]></change-notes>
    <!-- Product and plugin compatibility requirements.
         Read more: https://plugins.jetbrains.com/docs/intellij/plugin-compatibility.html -->
    <depends>com.intellij.modules.platform</depends>
    <depends>Git4Idea</depends>

    <projectListeners>
        <listener class="listener.MyToolWindowListener" topic="com.intellij.openapi.wm.ex.ToolWindowManagerListener"/>
        <listener class="listener.VcsStartup" topic="com.intellij.dvcs.repo.VcsRepositoryMappingListener"/>
        <listener class="listener.MyVirtualFileListener" topic="com.intellij.openapi.vfs.VirtualFileListener"/>
        <listener class="listener.MyChangeListListener" topic="com.intellij.openapi.vcs.changes.ChangeListListener"/>
        <listener class="listener.MyDynamicPluginListener" topic="com.intellij.ide.plugins.DynamicPluginListener"/>
        <listener class="listener.MyFileEditorManagerListener"
                  topic="com.intellij.openapi.fileEditor.FileEditorManagerListener"/>

        <!--        <listener class="listener.MouseListener" topic="com.intellij.openapi.editor.event.EditorMouseMotionListener"/>-->
        <!--        <listener class="listener.MyTabContentListener" topic="com.intellij.toolwindow.content.ContentManagerListener"/>-->
    </projectListeners>

    <!--    <applicationListeners>-->
    <!--        <listener class="listener.MyVfsListener" topic="com.intellij.openapi.vfs.newvfs.BulkFileListener"/>-->
    <!--    </applicationListeners>-->

    <!-- Extension points defined by the plugin.
         Read more: https://plugins.jetbrains.com/docs/intellij/plugin-extension-points.html -->
    <extensions defaultExtensionNs="com.intellij">

        <statusBarWidgetFactory
                implementation="statusBar.MyStatusBarWidgetFactory"/>
        <!--        <editorFactoryMouseMotionListener-->
        <!--                implementation="listener.MouseListener"/>-->
        <!--        <postStartupActivity implementation="listener.Startup"/>-->
        <!--        <vcsRepositoryCreator implementation="listener.VcsStartup"/>-->
        <!-- ToolWindow -->
        <!--                canCloseContents="true"-->
        <toolWindow
                id="Git Scope"
                secondary="true"
                icon="AllIcons.Actions.Diff"
                anchor="left"
                factoryClass="toolwindow.ToolWindowUIFactory"
                canCloseContents="true"
        />

        <!-- Config (Persistent) -->
        <projectService serviceImplementation="state.State"/>

        <projectService serviceImplementation="service.StatusBarService"/>
        <projectService serviceImplementation="service.GitService"/>
        <projectService serviceImplementation="service.ViewService"/>
        <projectService serviceImplementation="service.TargetBranchService"/>
        <projectService serviceImplementation="implementation.compare.ChangesService"/>
        <projectService
                serviceInterface="service.ToolWindowServiceInterface"
                serviceImplementation="service.ToolWindowService"/>
        <!--        <statusBarWidgetProvider implementation="toolwindow.TargetBranchStatusWidgetProvider"/>-->

    </extensions>

    <actions>
        <!--        <action id="actions.MakeCoffeeAction" class="actions.MakeCoffeeAction">-->
        <!--            <add-to-group group-id="ToolsMenu" anchor="last"/>-->
        <!--        </action>-->
        <action id="ToggleHead" class="listener.ToggleHeadAction" text="GitScope: Toggle Head" description="ToggleHead">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
            <keyboard-shortcut keymap="$default" first-keystroke="alt H"/>
        </action>
        <!--        <action id="listener.VcsContextMenuAction" class="listener.VcsContextMenuAction" text="Add to Git Scope">-->
        <!--            <add-to-group group-id="Vcs.Log.ContextMenu" anchor="after"-->
        <!--                          relative-to-action="Vcs.CopyRevisionNumberAction"/>-->
        <!--        </action>-->
    </actions>

</idea-plugin>